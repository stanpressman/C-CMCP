<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 1200">
  <defs>
    <style>
      .title { font: bold 24px sans-serif; fill: #1a1a1a; }
      .subtitle { font: 16px sans-serif; fill: #666; }
      .stage-title { font: bold 16px sans-serif; fill: #1a1a1a; }
      .stage-desc { font: 14px sans-serif; fill: #444; }
      .actor { font: bold 14px sans-serif; fill: #0066cc; }
      .file { font: 12px monospace; fill: #666; }
      .decision { font: 13px sans-serif; fill: #cc0000; }
      
      .box { fill: #f0f8ff; stroke: #0066cc; stroke-width: 2; }
      .approval-box { fill: #fff3cd; stroke: #ff9800; stroke-width: 2; }
      .validation-box { fill: #f0f0ff; stroke: #6600cc; stroke-width: 2; }
      .decision-box { fill: #ffe4e4; stroke: #cc0000; stroke-width: 2; }
      
      .arrow { fill: none; stroke: #333; stroke-width: 2; marker-end: url(#arrowhead); }
      .approval-arrow { fill: none; stroke: #ff9800; stroke-width: 2; marker-end: url(#arrowhead-orange); }
      .validation-arrow { fill: none; stroke: #6600cc; stroke-width: 2; marker-end: url(#arrowhead-purple); }
    </style>
    
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#333" />
    </marker>
    <marker id="arrowhead-orange" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#ff9800" />
    </marker>
    <marker id="arrowhead-purple" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#6600cc" />
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="400" y="30" text-anchor="middle" class="title">C-CMCP Workflow</text>
  <text x="400" y="55" text-anchor="middle" class="subtitle">Claude-Cursor Model Context Protocol</text>
  
  <!-- Stage 1: Design -->
  <rect x="50" y="80" width="700" height="100" class="box" rx="5"/>
  <text x="70" y="105" class="stage-title">Stage 1: Design (Claude.ai)</text>
  <text x="70" y="130" class="actor">Actor: Claude.ai + You</text>
  <text x="70" y="150" class="stage-desc">Create detailed task specification with MUST/SHOULD/COULD requirements</text>
  <text x="70" y="170" class="file">Output: claude-requests/task-*.md</text>
  
  <!-- Arrow -->
  <path d="M 400 180 L 400 210" class="arrow"/>
  
  <!-- Stage 2: Approval -->
  <rect x="50" y="210" width="700" height="100" class="approval-box" rx="5"/>
  <text x="70" y="235" class="stage-title">Stage 2: Task Approval (Human Gate)</text>
  <text x="70" y="260" class="actor">Actor: You + monitor-claude-requests.ps1</text>
  <text x="70" y="280" class="stage-desc">Review task, approve/reject/skip</text>
  <text x="70" y="300" class="file">Output: approved/task-*.md (STATUS: APPROVED)</text>
  
  <!-- Arrow -->
  <path d="M 400 310 L 400 340" class="approval-arrow"/>
  
  <!-- Stage 3: Processing -->
  <rect x="50" y="340" width="700" height="100" class="box" rx="5"/>
  <text x="70" y="365" class="stage-title">Stage 3: Mark for Processing</text>
  <text x="70" y="390" class="actor">Actor: process-approved-task.ps1</text>
  <text x="70" y="410" class="stage-desc">Change STATUS to PROCESSING, prepare for Cursor</text>
  <text x="70" y="430" class="file">Output: approved/task-*.md (STATUS: PROCESSING)</text>
  
  <!-- Arrow -->
  <path d="M 400 440 L 400 470" class="arrow"/>
  
  <!-- Stage 4: Implementation -->
  <rect x="50" y="470" width="700" height="120" class="box" rx="5"/>
  <text x="70" y="495" class="stage-title">Stage 4: Implementation (Cursor AI)</text>
  <text x="70" y="520" class="actor">Actor: Cursor AI</text>
  <text x="70" y="540" class="stage-desc">Read task, implement code changes, create response file</text>
  <text x="70" y="560" class="file">Output: cursor-responses/response-task-*.md</text>
  <text x="70" y="580" class="file">Modified: [your project files]</text>
  
  <!-- Arrow -->
  <path d="M 400 590 L 400 620" class="arrow"/>
  
  <!-- Stage 5: Validation -->
  <rect x="50" y="620" width="700" height="140" class="validation-box" rx="5"/>
  <text x="70" y="645" class="stage-title">Stage 5: QC Validation (API Claude)</text>
  <text x="70" y="670" class="actor">Actor: validate-cursor-work-v3.ps1 + API Claude</text>
  <text x="70" y="690" class="stage-desc">Validate implementation against requirements</text>
  <text x="70" y="710" class="stage-desc">Check: MUST requirements met? Code quality? Security?</text>
  <text x="70" y="730" class="file">Output: validation-reports/validation-task-*.md</text>
  <text x="70" y="750" class="decision">Result: PASS / FAIL / ADVISORY</text>
  
  <!-- Arrow -->
  <path d="M 400 760 L 400 790" class="validation-arrow"/>
  
  <!-- Stage 6: Review -->
  <rect x="50" y="790" width="700" height="120" class="approval-box" rx="5"/>
  <text x="70" y="815" class="stage-title">Stage 6: Manual Review (Human Gate)</text>
  <text x="70" y="840" class="actor">Actor: You</text>
  <text x="70" y="860" class="stage-desc">Read validation report + Test manually + Review code</text>
  <text x="70" y="880" class="stage-desc">Decide: Accept implementation? Request fixes? Reject?</text>
  <text x="70" y="900" class="decision">Decision Point: Accept or Reject</text>
  
  <!-- Arrow down -->
  <path d="M 400 910 L 400 940" class="approval-arrow"/>
  
  <!-- Stage 7: Decision -->
  <rect x="50" y="940" width="700" height="140" class="decision-box" rx="5"/>
  <text x="70" y="965" class="stage-title">Stage 7: Final Decision</text>
  <text x="70" y="990" class="actor">Actor: You</text>
  <text x="70" y="1015" class="stage-desc">✓ Accept: Click "Keep" in Cursor → Move to completed/</text>
  <text x="70" y="1040" class="stage-desc">✗ Reject: Request remediation → Back to Stage 4</text>
  <text x="70" y="1065" class="stage-desc">⚠ Manual Fix: Fix yourself → Document changes</text>
  
  <!-- Remediation loop -->
  <path d="M 50 1000 Q 20 800, 50 620" class="arrow" stroke-dasharray="5,5"/>
  <text x="15" y="810" class="decision" transform="rotate(-90 15 810)">Remediation Loop (max 2-3x)</text>
  
  <!-- Legend -->
  <text x="50" y="1110" class="stage-title">Legend:</text>
  <rect x="50" y="1120" width="30" height="20" class="box"/>
  <text x="90" y="1135" class="stage-desc">AI Process</text>
  
  <rect x="250" y="1120" width="30" height="20" class="approval-box"/>
  <text x="290" y="1135" class="stage-desc">Human Approval</text>
  
  <rect x="450" y="1120" width="30" height="20" class="validation-box"/>
  <text x="490" y="1135" class="stage-desc">Validation</text>
  
  <rect x="650" y="1120" width="30" height="20" class="decision-box"/>
  <text x="690" y="1135" class="stage-desc">Decision Point</text>
</svg>
